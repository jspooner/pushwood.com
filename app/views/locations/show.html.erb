<% content_for :title do %>
<%= @location.name %> - <%= @location.address %> - Skatepark Locator App
<% end %>
<% content_for :description do %>
<%= @location.description %>
<% end %>


<p id="notice"><%= notice %></p>

<div id="content">
	<h2><%= @location.name %></h2>
		
	<div id="pageAnchors">
		<ul class="clearfix">
			<li><a href="#map"><button class="minimal">Map</button></a></li>
			<li><a href="#info"><button class="minimal">Info</button></a></li>
			<% unless @location.images.empty? %>
			<li><a href="#photos"><button class="minimal">Photos</button></a></li>
			<% end %>
			<li><a href="#reviews"><button class="minimal">Reviews</button></a></li>
		</ul>
	</div>
	

	<div id="map" class="cont">
	</div>

	<div id="info" class="cont">
		<p>
			<strong>Address:</strong> <%= @location.address %><br>
			<span style="display:none" id="geo" lat="<%= @location.lat %>" lng="<%= @location.lng %>"></span>
			<span style="display:none" id="lat"><%= @location.lat %></span>
			<span style="display:none" id="lng"><%= @location.lng %></span>
			<strong>Has Lights:</strong> <%= (@location.has_lights?) ? "Yes" : "No" %><br>
			<strong>Videos:</strong> <%= link_to "YouTube", "http://www.youtube.com/results?search_query=#{@location.name}&aq=f" %>
		</p>
		<p>
			<strong>Description</strong><br>
			<%= @location.description.html_safe %>
		</p>
		<% if @location.cd_page and current_user %>
		<h4>Links</h4>
		<p>
			<%= link_to "concretediciples.com", @location.cd_page.url, :target => "blank" %>
		</p>
		<% end %>
	</div>
	
	<% unless @location.images.empty? %>
	<div id="photos" class="cont clearfix">
		<h4>Photos</h4>
		<% @location.images.each do |image| %>
			<a href="<%= image.img.url(:xlarge) %>" rel="imageGroup" class="gridImage"><%= image_tag image.img.url(:large_sq), %></a>
		<% end %>
	</div>
	<% end %>	
	
	<div id="reviews" class="cont">
		<h4>Reviews</h4>
		<ul>
			<% @location.comments.each do |comment| %>
				<li><%= comment.comment %></li>
			<% end %>
		</ul>
		<% if current_user %>
			<%= form_for([@location, Comment.new]) do|f| %> 
			  <%= f.hidden_field :commentable_id, :value => @location.id %>
			  <%= f.hidden_field :commentable_type, :value => 'Location' %> 
			  <%= f.label :comment, "Write a review" %><br /> 
			  <%= f.text_area :comment %> <br/>
			  <%= f.submit "Post Comment" %> 
			<% end %>
		<% end %>	
		<fb:comments href="<%= location_url(@location) %>" num_posts="5" width="528"></fb:comments>	
	</div>
	
	
</div>



<div id="sidebar">
  <div class="cont">
    <h3>Rating</h3>
    <%= render "rating" %>
  </div>
	<h3>Share</h3>
	<div class="cont">
		<fb:like href="<%= location_url(@location) %>" send="true" width="450" show_faces="true" action="like" font=""></fb:like>
	</div>	
	<div class="cont">
		<g:plusone></g:plusone>
	</div>
	<div class="cont">
		<iframe allowtransparency="true" frameborder="0" scrolling="no"
		        src="http://platform.twitter.com/widgets/tweet_button.html"
		        style="width:130px; height:20px;"></iframe>
	</div>
	<% if current_user && current_user.email == "jspooner@gmail.com" %>
	<div class="cont"><%= link_to 'Edit Location', edit_location_path(@location), :id => "editBtn" %></div>
	<% else %>
	<div class="cont">
		<h3>Update Content</h3>
		<p>Do you have updated information or photos for <%= @location.name %>?
			Just drop me an email at <a href="mailto:fixit@pushwood.com?subject=Fix <%= @location.id %>&body=http://pushwood.com/locations/<%= @location.id %>">fixit@pushwood.com</a>.</p>
	</div>
	<% end %>
	<div class="cont">
		<h3>Nearby Spots</h3>
		<ul>
		<% for location in @location.nearbys(20).sort { |a,b| a.distance.round(2) <=> b.distance.round(2)  } %>
		  <li><%= link_to location.name, location %> <em><%= location.distance.round(2) %> miles</em></li>
		<% end %>
		</ul>		
	</div>
</div>



<div id="fb-root"></div><script src="http://connect.facebook.net/en_US/all.js#appId=247714625258014&amp;xfbml=1"></script>
<!--  Place this tag after the last plusone tag -->
<script type="text/javascript">
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>


